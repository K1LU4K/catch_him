"use strict";!function(){var e=!1,t=!1,i=!1,n=void 0,s=void 0,a=void 0,r=void 0,o=document.getElementById("start-game"),c=document.getElementById("toggle-sidebar"),l=document.querySelector("."+c.dataset.toggle),d=document.querySelector(".toggle-sidebar-container"),u=document.querySelector(".grid-container"),v=document.querySelectorAll(".menu.difficulty a"),m=document.querySelectorAll(".menu.grid-size a"),L=v.length,f=m.length,p=void 0,y=document.querySelector(".grid"),g=y.dataset.difficulty,h=y.dataset.gridSize,w=y.dataset.timeActive,S=parseInt(w)+500,E=JSON.parse(y.dataset.gridSizeAvailable),b=void 0,q=void 0,T=void 0,k=document.querySelector(".win-container"),I=document.querySelector(".win-screen"),x=void 0,A=void 0,D=!1,z=void 0,H=document.querySelector(".mentions-container"),R=H.querySelector(".mentions"),N=document.querySelector("#mentions-button"),O=H.dataset.animationTime,W=!1,B=new XMLHttpRequest;!function e(){K();mobileAndTabletcheck()||window.innerWidth<1e3?(l.classList.add("mobile-browser"),u.classList.add("mobile-browser"),d.classList.remove("computer"),t||(c.addEventListener("click",F),t=!0)):(l.classList.remove("mobile-browser"),u.classList.remove("mobile-browser"),d.classList.add("computer"),t&&(c.removeEventListener("click",F),t=!1));i||(window.addEventListener("resize",e),i=!0)}(),o.addEventListener("click",C,{once:!0}),N.addEventListener("click",Y);for(var M=0;M<L;M++)v[M].addEventListener("click",Q);for(var j=0;j<f;j++)m[j].addEventListener("click",V);function C(e){e.preventDefault(),D=!1,(q=document.querySelector(".win"))&&q.classList.remove("win"),W&&Y(e,!0),u.classList.contains("mobile-browser")&&c.classList.contains("open")&&(c.classList.toggle("open"),l.classList.toggle("display")),k&&k.classList.contains("display")&&(k=document.querySelector(".win-container"),I=document.querySelector(".win-screen"),P()),o.innerText="Stop ?",o.addEventListener("click",G,{once:!0}),r=setInterval(function(){p="?difficulty="+encodeURIComponent(g)+"&grid-size="+encodeURIComponent(h)+"&ajax=true&cell=change",B.open("GET",p),B.onload=U,B.send()},S)}function G(e){e.preventDefault(),function(){for(var e=document.querySelectorAll(".cell.active"),t=0;t<e.length;t++)e[t].classList.remove("active")}(),o.innerText="Play ?",o.addEventListener("click",C,{once:!0}),clearInterval(r),clearTimeout(s)}function J(e){e.preventDefault();var t=T.id;B.open("GET","?ajax=true&cell=isWinner&cellId="+encodeURIComponent(t)),B.onload=X,B.send()}function U(){if(B.readyState==XMLHttpRequest.DONE){var e=JSON.parse(B.responseText);200===B.status?(b="cell"+e.cellId,(T=document.getElementById(b)).classList.add("active"),T.addEventListener("click",J),s=setTimeout(function(){T.removeEventListener("mousedown",J),T.classList.remove("active"),clearTimeout(s)},w)):(alert("Une erreur est survenu, sorry."),clearInterval(r))}}function X(){if(B.readyState==XMLHttpRequest.DONE){var e=JSON.parse(B.responseText);200===B.status?e.success&&(k=document.querySelector(".win-container"),I=document.querySelector(".win-screen"),x=document.getElementById("light-appeared"),A=document.getElementById("replay"),z=k.dataset.animationTime,T.removeEventListener("mousedown",J),o.innerText="Replay ?",o.removeEventListener("click",G),o.addEventListener("click",C,{once:!0}),k.classList.add("forward"),k.classList.add("display"),I.classList.add("animate"),k.addEventListener("click",P,{once:!0}),D=!0,x.innerText=e.nbrAppeared,A.addEventListener("click",C,{once:!0}),T.classList.remove("active"),T.classList.add("win"),clearInterval(r),clearTimeout(s)):(alert(e.error),clearInterval(r),clearTimeout(s))}}function P(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;e&&e.preventDefault(),I.classList.remove("animate"),k.classList.remove("display"),n=setTimeout(function(){k.classList.remove("forward"),clearTimeout(n)},z)}function F(e){e.preventDefault(),c.classList.toggle("open"),l.classList.toggle("display")}function K(){window.innerHeight>window.innerWidth||u.clientHeight>u.clientWidth?(u.classList.add("portrait"),l.classList.remove("landscape"),y.style.height=.95*u.clientWidth+"px",y.style.width=.95*u.clientWidth+"px"):(u.classList.remove("portrait"),l.classList.add("landscape"),y.style.width=.95*u.clientHeight+"px",y.style.height=.95*u.clientHeight+"px"),mobileAndTabletcheck()&&!e&&(window.addEventListener("deviceorientation",K),e=!0)}function Q(e){D?e.preventDefault():G(e);var t=this;p=this.getAttribute("href"),B.open("GET",p+"&ajax=true"),B.onload=function(){Z(".difficulty-button.active",t)},B.send()}function V(e){D?e.preventDefault():G(e);var t=this;p=this.getAttribute("href"),B.open("GET",p+"&ajax=true"),B.onload=function(){Z(".grid-size-button.active",t)},B.send()}function Y(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];e.stopPropagation(),e.preventDefault(),H=document.querySelector(".mentions-container"),R=H.querySelector(".mentions"),H.classList.contains("display")?(e.target===N||e.target===H||t)&&(W=!1,R.classList.remove("animate"),H.classList.remove("display"),a=setTimeout(function(){H.classList.remove("forward"),clearTimeout(a)},O),H.removeEventListener("click",Y)):(W=!0,u.classList.contains("mobile-browser")&&c.classList.contains("open")&&(c.classList.toggle("open"),l.classList.toggle("display")),H.classList.add("forward"),H.classList.add("display"),R.classList.add("animate"),H.addEventListener("click",Y))}function Z(e,t){if(B.readyState===XMLHttpRequest.DONE){var i=JSON.parse(B.responseText);if(200===B.status)if(document.querySelector(e).classList.remove("active"),t.classList.add("active"),a=i.grid,u.removeChild(y),u.innerHTML+=a,y=u.querySelector(".grid"),g=y.dataset.difficulty,w=y.dataset.timeActive,h=y.dataset.gridSize,S=parseInt(w)+1e3,K(),W&&Y(event,!0),e.match("difficulty"))for(var n=0;n<f;n++)m[n].setAttribute("href","?difficulty="+i.difficulty+"&grid-size="+E[n]);else for(var s=0;s<L;s++)v[s].setAttribute("href","?grid-size="+i.size+"&difficulty="+(s+1));else alert("An error is occured. Please try again later.")}var a}}();
"use strict";function mobileAndTabletcheck(){var i,a=!1;return i=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(i)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(i.substr(0,4)))&&(a=!0),a}